<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ph√¢n t√≠ch H·ªçc ph·∫ßn Gi√°o d·ª•c Qu·ªëc ph√≤ng - ƒêH ƒê·∫°i Nam</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .content {
            padding: 30px;
        }
        
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 5px;
            margin-bottom: 30px;
            overflow-x: auto;
        }
        
        .tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            white-space: nowrap;
            min-width: 150px;
        }
        
        .tab.active {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            border: 1px solid #e9ecef;
        }
        
        .card h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.4rem;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transform: translateY(0);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .stat-label {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }
        
        .table-container {
            overflow-x: auto;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        th, td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
        }
        
        th {
            background: #667eea;
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        .analysis-text {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            margin: 20px 0;
            line-height: 1.6;
        }
        
        .highlight {
            background: #fff3cd;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }
        
        .recommendation {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .recommendation h4 {
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .recommendation ul {
            list-style: none;
            padding-left: 0;
        }
        
        .recommendation li {
            padding: 5px 0;
            padding-left: 20px;
            position: relative;
        }
        
        .recommendation li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            font-weight: bold;
        }
        
        .filter-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
        }
        
        .filter-row {
            display: flex;
            gap: 20px;
            align-items: end;
            flex-wrap: wrap;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            min-width: 200px;
        }
        
        .filter-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .filter-select {
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1rem;
            background: white;
            transition: all 0.3s ease;
        }
        
        .filter-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .filter-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }
        
        .export-btn {
            background: linear-gradient(135deg, #fd7e14 0%, #e83e8c 100%);
        }
        
        .no-data {
            text-align: center;
            color: #6c757d;
            font-style: italic;
            padding: 40px;
        }
        
        .result-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .result-summary h4 {
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .summary-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .summary-number {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .summary-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .input-group {
            display: flex;
            gap: 15px;
            align-items: end;
            flex-wrap: wrap;
            margin-bottom: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .input-field {
            display: flex;
            flex-direction: column;
            min-width: 150px;
        }
        
        .input-field label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #2c3e50;
        }
        
        .input-field input, .input-field select {
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .input-field input:focus, .input-field select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .result-box {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }
        
        .result-box h4 {
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .highlight {
            background: rgba(255, 255, 255, 0.2);
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 700;
        }
        
        .warning {
            background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .schedule-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }
        
        .schedule-item h5 {
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            height: 100%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8rem;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéì Ph√¢n t√≠ch H·ªçc ph·∫ßn Gi√°o d·ª•c Qu·ªëc ph√≤ng</h1>
            <p>Tr∆∞·ªùng ƒê·∫°i h·ªçc ƒê·∫°i Nam - H·ªá th·ªëng qu·∫£n l√Ω v√† ph√¢n t√≠ch d·ªØ li·ªáu</p>
        </div>
        
        <div class="content">
            <div class="tabs">
                <div class="tab active" onclick="showTab('overview')">T·ªïng quan</div>
                <!-- <div class="tab" onclick="showTab('analysis')">Ph√¢n t√≠ch hi·ªán t·∫°i</div> -->
                <div class="tab" onclick="showTab('charts')">Bi·ªÉu ƒë·ªì</div>
                <div class="tab" onclick="showTab('schedule')">ƒê·ªÅ xu·∫•t l·ªãch h·ªçc</div>
                <div class="tab" onclick="showTab('calculator')">T√≠nh to√°n ƒë·ª£t h·ªçc & x·∫øp l·ªãch h·ªçc </div>
                <!-- <div class="tab" onclick="showTab('statistics')">Th·ªëng k√™ theo nƒÉm</div> -->
                <!-- <div class="tab" onclick="showTab('filter')">L·ªçc & Xu·∫•t Excel</div> -->
            </div>
            
            <!-- Tab T·ªïng quan -->
        <div id="overview" class="tab-content active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">22</div>
                        <div class="stat-label">Khoa trong tr∆∞·ªùng</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">38-40</div>
                        <div class="stat-label">Tu·∫ßn h·ªçc kh·∫£ d·ª•ng</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">3-4</div>
                        <div class="stat-label">Tu·∫ßn/ƒë·ª£t h·ªçc</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">400-600</div>
                        <div class="stat-label">SV/ƒë·ª£t h·ªçc</div>
                    </div>
                      <div class="stat-card">
                        <div class="stat-number">28,300K</div>
                        <div class="stat-label">Sinh vi√™n t·ª´ nƒÉm 2025-2028 c·∫ßn h·ªçc GDQP</div>
                    </div>
                </div>
                
                <div class="card">
                    <h3>üìä Th√¥ng tin c∆° b·∫£n v·ªÅ h·ªçc ph·∫ßn</h3>
                    <div class="analysis-text">
                        <p><strong>H·ªçc ph·∫ßn:</strong> Gi√°o d·ª•c Qu·ªëc ph√≤ng (b·∫Øt bu·ªôc cho t·∫•t c·∫£ sinh vi√™n)</p>
                        <p><strong>Th·ªùi gian nƒÉm h·ªçc:</strong> Th√°ng 8 nƒÉm nay ‚Üí Th√°ng 7-8 nƒÉm sau</p>
                        <p><strong>C·∫•u tr√∫c nƒÉm h·ªçc:</strong> 52 tu·∫ßn (12-14 tu·∫ßn ngh·ªâ/ho·∫°t ƒë·ªông kh√°c + 38-40 tu·∫ßn h·ªçc)</p>
                        <p><strong>Quy m√¥ ƒë√†o t·∫°o:</strong> 4,000 sinh vi√™n/nƒÉm h·ªçc</p>
                        <p><strong>NƒÉm h·ªçc 2024-2025:</strong> 11 ƒë·ª£t h·ªçc ƒë√£ ƒë∆∞·ª£c t·ªï ch·ª©c</p>
                    </div>
                </div>
                
                <div class="card">
                    <h3>üë• Th√¥ng tin sinh vi√™n c√°c kh√≥a</h3>
                    <div style="margin-bottom: 15px;">
                        <button class="btn export-btn" onclick="exportOverviewToExcel()">üìä Xu·∫•t Excel - Th√¥ng tin c√°c kh√≥a</button>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Kh√≥a</th>
                                    <th>T·ªïng s·ªë SV</th>
                                    <th>SV ho√†n th√†nh 2024-2025</th>
                                    <th>T·ª∑ l·ªá ho√†n th√†nh</th>
                                    <th>Tr·∫°ng th√°i</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Kh√≥a 16</strong></td>
                                    <td>3,000</td>
                                    <td>400-600</td>
                                    <td>13-20%</td>
                                    <td>G·∫ßn ho√†n th√†nh</td>
                                </tr>
                                <tr>
                                    <td><strong>Kh√≥a 17</strong></td>
                                    <td>5,300</td>
                                    <td>2000-3500</td>
                                    <td>72-100%</td>
                                    <td>ƒêang h·ªçc ch√≠nh</td>
                                </tr>
                                <tr>
                                    <td><strong>Kh√≥a 18</strong></td>
                                    <td>6,000</td>
                                    <td>200-300</td>
                                    <td>3-5%</td>
                                    <td>M·ªõi b·∫Øt ƒë·∫ßu</td>
                                </tr>
                                <tr>
                                    <td><strong>Kh√≥a 19</strong></td>
                                    <td>6,000-8,000</td>
                                    <td>0</td>
                                    <td>0%</td>
                                    <td>S·∫Øp nh·∫≠p h·ªçc</td>
                                </tr>
                                <tr>
                                    <td><strong>Kh√≥a 20</strong></td>
                                    <td>6,000-8,000</td>
                                    <td>0</td>
                                    <td>0%</td>
                                    <td>S·∫Øp nh·∫≠p h·ªçc</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- Tab Ph√¢n t√≠ch 
            <div id="analysis" > -->
                <div class="card">
                    <h3>üîç Ph√¢n t√≠ch t√¨nh h√¨nh hi·ªán t·∫°i</h3>
                    <div class="analysis-text">
                        <h4>1. Ph√¢n t√≠ch nƒÉm h·ªçc 2024-2025:</h4>
                        <p>‚Ä¢ <span class="highlight">11 ƒë·ª£t h·ªçc</span> ƒë√£ t·ªï ch·ª©c v·ªõi t·ªïng c·ªông kho·∫£ng 4000-4500 sinh vi√™n ho√†n th√†nh</p>
                        <p>‚Ä¢ Kh√≥a 17 chi·∫øm t·ª∑ tr·ªçng l·ªõn nh·∫•t (86-86.4% t·ªïng s·ªë sinh vi√™n ho√†n th√†nh nƒÉm h·ªçc)</p>
                        <p>‚Ä¢ C√≥ 1 ƒë·ª£t h·ªçc chung gi·ªØa kh√≥a 17 v√† kh√≥a 18 </p>
                        
                        <h4>2. T√≠nh to√°n s·ªë ƒë·ª£t c·∫ßn thi·∫øt:</h4>
                        <p>‚Ä¢ <strong>T·ªïng sinh vi√™n c·∫ßn h·ªçc:</strong> 20,300-25,300 sinh vi√™n (t·∫•t c·∫£ c√°c kh√≥a)</p>
                        <p>‚Ä¢ <strong>Kh·∫£ nƒÉng ƒë√†o t·∫°o/ƒë·ª£t:</strong> 400-600 sinh vi√™n</p>
                        <p>‚Ä¢ <strong>S·ªë ƒë·ª£t c·∫ßn thi·∫øt:</strong> 34-63 ƒë·ª£t (t√πy theo quy m√¥ m·ªói ƒë·ª£t)</p>
                        <p>‚Ä¢ <strong>Th·ªùi gian c·∫ßn:</strong> 3-5 nƒÉm h·ªçc ƒë·ªÉ ho√†n th√†nh t·∫•t c·∫£</p>
                        
                        <h4>3. Th√°ch th·ª©c:</h4>
                        <p>‚Ä¢ S·ªë l∆∞·ª£ng sinh vi√™n tƒÉng m·∫°nh t·ª´ kh√≥a 17 tr·ªü ƒëi</p>
                        <p>‚Ä¢ Kh·∫£ nƒÉng ƒë√†o t·∫°o h·∫°n ch·∫ø (ch·ªâ 38-40 tu·∫ßn/nƒÉm, 3-4 tu·∫ßn/ƒë·ª£t)</p>
                        <p>‚Ä¢ C·∫ßn t·ªëi ∆∞u h√≥a vi·ªác x·∫øp l·ªãch ƒë·ªÉ tƒÉng hi·ªáu qu·∫£</p>
                    </div>
                </div>

                
                <div class="recommendation">
                    <h4>üí° ƒê·ªÅ xu·∫•t gi·∫£i ph√°p:</h4>
                    <ul>
                        <li>TƒÉng quy m√¥ m·ªói ƒë·ª£t l√™n 600 sinh vi√™n</li>
                        <li>T·ªï ch·ª©c 12-13 ƒë·ª£t/nƒÉm h·ªçc thay v√¨ 11 ƒë·ª£t</li>
                        <li>∆Øu ti√™n ho√†n th√†nh kh√≥a 16 trong nƒÉm 2024-2025, ƒë·ªÉ ho√†n th√†nh tr∆∞·ªõc th·ªùi gian thi t·ªët nghi·ªáp v√† th·ªùi gian ƒëi th·ª±c t·∫≠p.</li>
                        <li>X·∫øp l·ªãch h·ª£p l√Ω cho kh√≥a 17, 18 trong c√°c nƒÉm ti·∫øp theo</li>
                        <li>Chu·∫©n b·ªã s·∫µn k·∫ø ho·∫°ch cho kh√≥a 19, 20</li>
                    </ul>
                </div>


                <!-- Tab L·ªçc & Xu·∫•t Excel -->
            <div id="filter" >
                <div class="card">
                    <h3>üîç L·ªçc d·ªØ li·ªáu v√† xu·∫•t Excel</h3>
                    
                    <div class="filter-section">
                        <div class="filter-row">
                            <div class="filter-group">
                                <label for="courseSelect">Ch·ªçn kh√≥a h·ªçc:</label>
                                <select id="courseSelect" class="filter-select">
                                    <option value="">-- T·∫•t c·∫£ kh√≥a --</option>
                                    <option value="16">Kh√≥a 16</option>
                                    <option value="17">Kh√≥a 17</option>
                                    <option value="18">Kh√≥a 18</option>
                                    <option value="19">Kh√≥a 19</option>
                                    <option value="20">Kh√≥a 20</option>
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label for="yearSelect">Ch·ªçn nƒÉm h·ªçc:</label>
                                <select id="yearSelect" class="filter-select">
                                    <option value="">-- T·∫•t c·∫£ nƒÉm --</option>
                                    <option value="2022-2023">2022-2023</option>
                                    <option value="2023-2024">2023-2024</option>
                                    <option value="2024-2025">2024-2025</option>
                                    <option value="2025-2026">2025-2026</option>
                                    <option value="2026-2027">2026-2027</option>
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <button class="btn filter-btn" onclick="applyFilter()">üîç L·ªçc d·ªØ li·ªáu</button>
                                <button class="btn export-btn" onclick="exportToExcel()">üìä Xu·∫•t Excel</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h3>üìã K·∫øt qu·∫£ l·ªçc</h3>
                    <div id="filterResults">
                        <p class="no-data">Vui l√≤ng ch·ªçn ƒëi·ªÅu ki·ªán l·ªçc v√† nh·∫•n "L·ªçc d·ªØ li·ªáu" ƒë·ªÉ xem k·∫øt qu·∫£.</p>
                    </div>
                </div>
            </div>
        </div>


            </div>
    </div>
            
            
            
            <!-- Tab Bi·ªÉu ƒë·ªì -->
     <div id="charts" class="tab-content">
                <!-- Stacked Chart 
                <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-xl shadow-lg p-6">-->
                <div class="card">
                    <h3> D·ª± ƒëo√°n sinh vi√™n ho√†n th√†nh theo kh√≥a v√† nƒÉm </h3>
                    <div class="chart-container">
                        <canvas id="gdqpChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <h3>üìà Bi·ªÉu ƒë·ªì ph√¢n t√≠ch</h3>
                    <div class="chart-container">
                        <canvas id="studentChart"></canvas>
                    </div>
                </div>
                
                <div class="card">
                    <h3>üìä Ti·∫øn ƒë·ªô ho√†n th√†nh theo kh√≥a</h3>
                    <div class="chart-container">
                        <canvas id="progressChart"></canvas>
                    </div>
                </div>
                
                <div class="card">
                    <h3>üìÖ D·ª± b√°o s·ªë ƒë·ª£t c·∫ßn thi·∫øt</h3>
                    <div class="chart-container"> 
                        <canvas id="forecastChart"></canvas>
                    </div>
                </div>


                 <!-- Tab Th·ªëng k√™ -->
            <div>
                <div class="card">
                    <h3>üìä Th·ªëng k√™ sinh vi√™n ho√†n th√†nh theo nƒÉm h·ªçc</h3>
                    <div style="margin-bottom: 15px;">
                        <button class="btn export-btn" onclick="exportStatisticsToExcel()">üìä Xu·∫•t Excel - Th·ªëng k√™ theo nƒÉm</button>
                    </div>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Kh√≥a</th>
                                    <th>2022-2023</th>
                                    <th>2023-2024</th>
                                    <th>2024-2025</th>
                                    <th>2025-2026</th>
                                    <th>2026-2027</th>
                                    <th>2027-2028</th>
                                    <th>T·ªïng</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Kh√≥a 16</strong></td>
                                    <td>1,200</td>
                                    <td>1,707</td>
                                    <td>953</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>3,000</td>
                                </tr>
                                <tr>
                                    <td><strong>Kh√≥a 17</strong></td>
                                    <td>-</td>
                                    <td>2,164</td>
                                    <td>2,682</td>
                                    <td>454</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>5,300</td>
                                </tr>
                                <tr>
                                    <td><strong>Kh√≥a 18</strong></td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>127</td>
                                    <td>2,850</td>
                                    <td>3000</td>
                                    <td>-</td>
                                    <td>6,000</td>
                                </tr>
                                <tr>
                                    <td><strong>Kh√≥a 19</strong></td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>1,034</td>
                                    <td>1,333</td>
                                    <td>1,333</td>
                                    <td>6,000</td>
                                </tr>
                                <tr>
                                    <td><strong>Kh√≥a 20</strong></td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>1,334</td>
                                    <td>1,333</td>
                                    <td>7,000</td>
                                </tr>
                                <tr style="background: #f8f9fa; font-weight: bold;">
                                    <td><strong>T·ªïng/nƒÉm</strong></td>
                                    <td>-</td>
                                    <td>3,871</td>
                                    <td>3,873</td>
                                    <td>4,338</td>
                                    <td>5,667</td>
                                    <td>-</td>
                                    <td>28,300</td>
                                </tr>
                            </tbody>
                        </table>
                        <br>
                        <p>Ch√∫ th√≠ch: k14 h·ªçc g·ªôp m·ªôt kh√≥a v·ªõi k17 nƒÉm h·ªçc 2024-2025 </p>
                    </div>
                    
                    <div class="analysis-text">
                        <h4>Ghi ch√∫ v·ªÅ d·ªØ li·ªáu:</h4>
                        <p>‚Ä¢ S·ªë li·ªáu nƒÉm 2022-2023 v√† 2023-2024 cho kh√≥a 16 ƒë∆∞·ª£c t√≠nh to√°n d·ª±a tr√™n t·ªïng s·ªë 3,000 sinh vi√™n</p>
                        <p>‚Ä¢ Kh√≥a 17 b·∫Øt ƒë·∫ßu t·ª´ nƒÉm 2023-2024 v·ªõi s·ªë l∆∞·ª£ng nh·ªè, ch·ªß y·∫øu ho√†n th√†nh trong 2024-2025</p>
                        <p>‚Ä¢ Kh√≥a 18 m·ªõi b·∫Øt ƒë·∫ßu trong 2024-2025, s·∫Ω ho√†n th√†nh ch·ªß y·∫øu trong 2025-2026</p>
                        <p>‚Ä¢ Kh√≥a 19 v√† 20 ƒë∆∞·ª£c d·ª± b√°o v·ªõi quy m√¥ 7,000 sinh vi√™n m·ªói kh√≥a</p>
                    </div>
                </div>
                
                <div class="card">
                    <h3>üìà Xu h∆∞·ªõng tƒÉng tr∆∞·ªüng</h3>
                    <div class="chart-container">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>
            </div>

        </div>
            
            
            <!-- Tab ƒê·ªÅ xu·∫•t l·ªãch h·ªçc -->
            <div id="schedule" class="tab-content">
                <div class="card">
                    <h3>üìÖ ƒê·ªÅ xu·∫•t l·ªãch h·ªçc h·ª£p l√Ω</h3>
                    
                    <h4>NƒÉm h·ªçc 2024-2025 (c√≤n l·∫°i), quy m√¥ 600 sinh vi√™n/ ƒë·ª£t:</h4>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ƒê·ª£t</th>
                                    <th>Th·ªùi gian</th>
                                    <th>Kh√≥a</th>
                                    <th>S·ªë SV</th>
                                    <th>Ghi ch√∫</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ƒê·ª£t 12</td>
                                    <td>Th√°ng 4-5/2025</td>
                                    <td>Kh√≥a 17</td>
                                    <td>600</td>
                                    <td>Ho√†n th√†nh kh√≥a 17</td>
                                </tr>
                                <tr>
                                    <td>ƒê·ª£t 13</td>
                                    <td>Th√°ng 6-7/2025</td>
                                    <td>Kh√≥a 18</td>
                                    <td>600</td>
                                    <td>B·ªï sung kh√≥a 18</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <h4>NƒÉm h·ªçc 2025-2026:</h4>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ƒê·ª£t</th>
                                    <th>Th·ªùi gian</th>
                                    <th>Kh√≥a</th>
                                    <th>S·ªë SV</th>
                                    <th>M·ª•c ti√™u</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1-4</td>
                                    <td>Th√°ng 8-12/2025</td>
                                    <td>Kh√≥a 18</td>
                                    <td>2,400</td>
                                    <td>∆Øu ti√™n kh√≥a 18</td>
                                </tr>
                                <tr>
                                    <td>5-8</td>
                                    <td>Th√°ng 1-4/2026</td>
                                    <td>Kh√≥a 18</td>
                                    <td>2,400</td>
                                    <td>Ti·∫øp t·ª•c kh√≥a 18</td>
                                </tr>
                                <tr>
                                    <td>9-12</td>
                                    <td>Th√°ng 5-7/2026</td>
                                    <td>Kh√≥a 19</td>
                                    <td>2,400</td>
                                    <td>B·∫Øt ƒë·∫ßu kh√≥a 19</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>   
            
<!-- Tab T√≠nh to√°n -->
            <div id="calculator" class="tab-content">
                <div class="card">
                    <h3>üßÆ T√≠nh to√°n s·ªë ƒë·ª£t v√† tu·∫ßn h·ªçc 2025-2028</h3>
                    
                    <div class="input-group">
                        <div class="input-field">
                            <label>S·ªë sinh vi√™n c·∫ßn h·ªçc:</label>
                            <input type="number" id="totalStudents" value="20250" min="1">
                        </div>
                        <div class="input-field">
                            <label>Sinh vi√™n/ƒë·ª£t:</label>
                            <input type="number" id="studentsPerBatch" value="600" min="100" max="1000">
                        </div>
                        <div class="input-field">
                            <label>Tu·∫ßn/ƒë·ª£t:</label>
                            <input type="number" id="weeksPerBatch" value="3" min="2" max="5">
                        </div>
                        <div class="input-field">
                            <label>Tu·∫ßn h·ªçc/nƒÉm:</label>
                            <input type="number" id="weeksPerYear" value="38" min="30" max="45">
                        </div>
                        <div class="input-field">
                            <button class="btn" onclick="calculateBatches()">üìä T√≠nh to√°n</button>
                        </div>
                    </div>
                    
                    <div id="calculationResult"></div>
                </div>
                
                <div class="card">
                    <h3>üìà Ph√¢n b·ªï theo kh√≥a</h3>
                    
                    <div class="input-group">
                        <div class="input-field">
                            <label>Ch·ªçn kh√≥a:</label>
                            <select id="CourseSelect">
                                <option value="16">Kh√≥a 16 (500 SV c√≤n l·∫°i)</option>
                                <option value="17">Kh√≥a 17 (500 SV c√≤n l·∫°i)</option>
                                <option value="18">Kh√≥a 18 (5,750 SV c√≤n l·∫°i)</option>
                                <option value="19">Kh√≥a 19 (7,000 SV c√≤n l·∫°i)</option>
                                <option value="20">Kh√≥a 20 (7,000 SV c√≤n l·∫°i)</option>
                            </select>
                        </div>
                        <div class="input-field">
                            <label>∆Øu ti√™n (1-5):</label>
                            <input type="number" id="priority" value="1" min="1" max="5">
                        </div>
                        <div class="input-field">
                            <button class="btn" onclick="calculateCourse()">üéØ T√≠nh cho kh√≥a</button>
                        </div>
                    </div>
                    
                    <div id="courseResult"></div>
                </div>

 <!-- Tab X·∫øp l·ªãch -->
            <div>
                <div class="card">
                    <h3>üìÖ X·∫øp l·ªãch h·ªçc t·ª± ƒë·ªông</h3>
                    
                    <div class="input-group">
                        <div class="input-field">
                            <label>NƒÉm h·ªçc b·∫Øt ƒë·∫ßu:</label>
                            <select id="startYear">
                                <option value="2024">2024-2025</option>
                                <option value="2025">2025-2026</option>
                                <option value="2026">2026-2027</option>
                            </select>
                        </div>
                        <div class="input-field">
                            <label>S·ªë ƒë·ª£t t·ªëi ƒëa/nƒÉm:</label>
                            <input type="number" id="maxBatchesPerYear" value="12" min="8" max="15">
                        </div>
                        <div class="input-field">
                            <label>Chi·∫øn l∆∞·ª£c x·∫øp l·ªãch:</label>
                            <select id="strategy">
                                <option value="priority">∆Øu ti√™n kh√≥a c≈©</option>
                                <option value="balanced">C√¢n b·∫±ng c√°c kh√≥a</option>
                                <option value="capacity">T·ªëi ∆∞u c√¥ng su·∫•t</option>
                            </select>
                        </div>
                        <div class="input-field">
                            <button class="btn" onclick="generateSchedule()">üóìÔ∏è T·∫°o l·ªãch h·ªçc</button>
                        </div>
                    </div>
                    
                    <div id="scheduleResult"></div>
                </div>
                
                <div class="card">
                    <h3>üìä Xu·∫•t k·∫ø ho·∫°ch</h3>
                    <button class="btn" onclick="exportSchedule()">üìÑ Xu·∫•t Excel</button>
                    <button class="btn" onclick="exportSummary()">üìã Xu·∫•t t√≥m t·∫Øt</button>
                </div>
            </div>
        </div>

            




    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // Tab switching functionality
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
            
            // Initialize charts when charts tab is shown
            if (tabName === 'charts') {
                setTimeout(initCharts, 100);
            }
           // if (tabName === 'statistics') {
           //     setTimeout(initTrendChart, 100);
           // }
        }
        
        // Initialize charts C√ÅC TH·ªÇ LO·∫†I BI·ªÇU ƒê·ªí
        function initCharts() {
            // Student distribution chart
            const ctx1 = document.getElementById('studentChart').getContext('2d');
            if (ctx1) {
                new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: ['Kh√≥a 16', 'Kh√≥a 17', 'Kh√≥a 18', 'Kh√≥a 19', 'Kh√≥a 20'],
                        datasets: [{
                            label: 'T·ªïng s·ªë sinh vi√™n',
                            data: [3000, 5300, 6000, 7000, 7000],
                            backgroundColor: 'rgba(102, 126, 234, 0.8)',
                            borderColor: 'rgba(102, 126, 234, 1)',
                            borderWidth: 2
                        }, {
                            label: 'ƒê√£ ho√†n th√†nh 2024-2025',
                            data: [500, 4500, 250, 0, 0],
                            backgroundColor: 'rgba(40, 167, 69, 0.8)',
                            borderColor: 'rgba(40, 167, 69, 1)',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Ph√¢n b·ªë sinh vi√™n theo kh√≥a'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
            
            // Progress chart
            const ctx2 = document.getElementById('progressChart');
            if (ctx2) {
                new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: ['Kh√≥a 16', 'Kh√≥a 17', 'Kh√≥a 18', 'Ch∆∞a h·ªçc'],
                        datasets: [{
                            data: [500, 4500, 250, 23050],
                            backgroundColor: [
                                'rgba(255, 193, 7, 0.8)',
                                'rgba(40, 167, 69, 0.8)',
                                'rgba(102, 126, 234, 0.8)',
                                'rgba(220, 53, 69, 0.8)'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'T·ª∑ l·ªá ho√†n th√†nh nƒÉm 2024-2025'
                            }
                        }
                    }
                });
            }
            
            // Forecast chart
            const ctx3 = document.getElementById('forecastChart');
            if (ctx3) {
                new Chart(ctx3, {
                    type: 'line',
                    data: {
                        labels: ['2024-2025', '2025-2026', '2026-2027', '2027-2028', '2028-2029'],
                        datasets: [{
                            label: 'S·ªë ƒë·ª£t c·∫ßn thi·∫øt',
                            data: [13, 14, 15, 12, 10],
                            borderColor: 'rgba(102, 126, 234, 1)',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'D·ª± b√°o s·ªë ƒë·ª£t h·ªçc c·∫ßn thi·∫øt theo nƒÉm'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
        }
        
       // function initTrendChart() {
            const ctx = document.getElementById('trendChart');
            if (ctx) {
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['2022-2023', '2023-2024', '2024-2025', '2025-2026', '2026-2027'],
                        datasets: [{
                            label: 'T·ªïng SV ho√†n th√†nh/nƒÉm',
                            data: [1200, 2200, 3873, 4400, 5650],
                            borderColor: 'rgba(102, 126, 234, 1)',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Xu h∆∞·ªõng tƒÉng tr∆∞·ªüng s·ªë sinh vi√™n ho√†n th√†nh'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }
     //   }
// bi·ªÉu ƒë·ªì ch·ªìng
// Load stacked chart function
//       function loadChart() {
            const ctx4 = document.getElementById('gdqpChart');
            try {
                // Since we can't load external files, we'll use sample data
                const data = {
                    labels: ['2022-2023', '2023-2024', '2024-2025', '2025-2026', '2026-2027', '2027-2028'],
                    datasets: [
                        {
                            label: 'Kh√≥a 14',
                            data: [791, 792, 237, 0, 0, 0],
                            color: '#3B82F6'
                        },
                        {
                            label: 'Kh√≥a 15',
                            data: [1225, 1225, 0, 0, 0, 0],
                            color: '#10B981'
                        },
                        {
                            label: 'Kh√≥a 16',
                            data: [1500, 546, 954, 0, 0, 0],
                            color: '#F59E0B'
                        },
                        {
                            label: 'Kh√≥a 17',
                            data: [0, 1500, 2682, 454, 0, 0],
                            color: '#EF4444'
                        },
                        {
                            label: 'Kh√≥a 18',
                            data: [0, 0, 164, 2850, 3000, 0],
                            color: '#8B5CF6'
                        },
                        // t·ª´ k18 t·ª©c 2025-2026 s·ªë sinh. ph·∫£i h·ªçc s·∫Ω l√† 600 sinh vi√™n up
                        {
                            label: 'Kh√≥a 19',
                            data: [0, 0, 0, 1034, 1333, 1333],
                            color: '#06B6D4'
                        },
                        {
                            label: 'Kh√≥a 20',
                            data: [0, 0, 0, 0, 1334, 1333],
                            color: '#84CC16'
                        }
                    ]
                };

                const ctx4 = document.getElementById('gdqpChart').getContext('2d');
                new Chart(ctx4, {
                    type: 'bar',
                    data: {
                        labels: data.labels,
                        datasets: data.datasets.map(ds => ({
                            label: ds.label,
                            data: ds.data,
                            backgroundColor: ds.color,
                            borderWidth: 1
                        }))
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { 
                                position: 'right', 
                                labels: { color: '#000000' } 
                            },
                            title: { 
                                display: true, 
                                text: 'Sinh vi√™n ho√†n th√†nh GDQP theo nƒÉm & kh√≥a', 
                                color: '#0000000', 
                                font: { size: 20 } 
                            }
                        },
                        scales: {
                            x: { 
                                stacked: true, 
                                ticks: { color: '#808080' },
                                grid: { color: 'rgba(255, 255, 255, 0.1)' }
                            },
                            y: { 
                                stacked: true, 
                                ticks: { color: '#808080' },
                                grid: { color: 'rgba(255, 255, 255, 0.1)' }
                            }
                        }
                    }
                });
            } catch (err) {
                console.error("Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu bi·ªÉu ƒë·ªì:", err);
            }
//        }

        
        // Data for filtering and export
        const studentData = {
            '16': {
                total: 3000,
                graduated: {
                    '2022-2023': 1200,
                    '2023-2024': 1400,
                    '2024-2025': 500,
                    '2025-2026': 0,
                    '2026-2027': 0
                }
            },
            '17': {
                total: 5300,
                graduated: {
                    '2022-2023': 0,
                    '2023-2024': 800,
                    '2024-2025': 4500,
                    '2025-2026': 0,
                    '2026-2027': 0
                }
            },
            '18': {
                total: 6000,
                graduated: {
                    '2022-2023': 0,
                    '2023-2024': 0,
                    '2024-2025': 250,
                    '2025-2026': 4800,
                    '2026-2027': 950
                }
            },
            '19': {
                total: 7000,
                graduated: {
                    '2022-2023': 0,
                    '2023-2024': 0,
                    '2024-2025': 0,
                    '2025-2026': 3500,
                    '2026-2027': 3500
                }
            },
            '20': {
                total: 7000,
                graduated: {
                    '2022-2023': 0,
                    '2023-2024': 0,
                    '2024-2025': 0,
                    '2025-2026': 0,
                    '2026-2027': 4200
                }
            }
        };
        
        let filteredData = [];
        
        function applyFilter() {
            const courseSelect = document.getElementById('courseSelect').value;
            const yearSelect = document.getElementById('yearSelect').value;
            const resultsDiv = document.getElementById('filterResults');
            
            filteredData = [];
            
            if (!courseSelect && !yearSelect) {
                resultsDiv.innerHTML = '<p class="no-data">Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt ƒëi·ªÅu ki·ªán l·ªçc.</p>';
                return;
            }
            
            // Filter data based on selection
            for (let course in studentData) {
                if (courseSelect && course !== courseSelect) continue;
                
                for (let year in studentData[course].graduated) {
                    if (yearSelect && year !== yearSelect) continue;
                    
                    const graduatedCount = studentData[course].graduated[year];
                    if (graduatedCount > 0) {
                        filteredData.push({
                            course: `Kh√≥a ${course}`,
                            year: year,
                            total: studentData[course].total,
                            graduated: graduatedCount,
                            remaining: studentData[course].total - Object.values(studentData[course].graduated).reduce((a, b) => a + b, 0)
                        });
                    }
                }
            }
            
            displayFilterResults();
        }
        
        function displayFilterResults() {
            const resultsDiv = document.getElementById('filterResults');
            
            if (filteredData.length === 0) {
                resultsDiv.innerHTML = '<p class="no-data">Kh√¥ng c√≥ d·ªØ li·ªáu ph√π h·ª£p v·ªõi ƒëi·ªÅu ki·ªán l·ªçc.</p>';
                return;
            }
            
            // Calculate summary
            const totalGraduated = filteredData.reduce((sum, item) => sum + item.graduated, 0);
            const uniqueCourses = [...new Set(filteredData.map(item => item.course))];
            const uniqueYears = [...new Set(filteredData.map(item => item.year))];
            
            let html = `
                <div class="result-summary">
                    <h4>üìä T√≥m t·∫Øt k·∫øt qu·∫£ l·ªçc</h4>
                    <div class="summary-stats">
                        <div class="summary-item">
                            <div class="summary-number">${filteredData.length}</div>
                            <div class="summary-label">B·∫£n ghi</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number">${uniqueCourses.length}</div>
                            <div class="summary-label">Kh√≥a h·ªçc</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number">${uniqueYears.length}</div>
                            <div class="summary-label">NƒÉm h·ªçc</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number">${totalGraduated.toLocaleString()}</div>
                            <div class="summary-label">T·ªïng SV ra tr∆∞·ªùng</div>
                        </div>
                    </div>
                </div>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>STT</th>
                                <th>Kh√≥a h·ªçc</th>
                                <th>NƒÉm h·ªçc</th>
                                <th>T·ªïng s·ªë SV kh√≥a</th>
                                <th>SV ra tr∆∞·ªùng nƒÉm ƒë√≥</th>
                                <th>T·ª∑ l·ªá (%)</th>
                                <th>SV c√≤n l·∫°i</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            filteredData.forEach((item, index) => {
                const percentage = ((item.graduated / item.total) * 100).toFixed(1);
                html += `
                    <tr>
                        <td>${index + 1}</td>
                        <td><strong>${item.course}</strong></td>
                        <td>${item.year}</td>
                        <td>${item.total.toLocaleString()}</td>
                        <td>${item.graduated.toLocaleString()}</td>
                        <td>${percentage}%</td>
                        <td>${Math.max(0, item.remaining).toLocaleString()}</td>
                    </tr>
                `;
            });
            
            html += `
                        </tbody>
                    </table>
                </div>
            `;
            
            resultsDiv.innerHTML = html;
        }
        
        function exportToExcel() {
            if (filteredData.length === 0) {
                alert('Vui l√≤ng l·ªçc d·ªØ li·ªáu tr∆∞·ªõc khi xu·∫•t Excel!');
                return;
            }
            
            // Prepare data for Excel
            const excelData = filteredData.map((item, index) => ({
                'STT': index + 1,
                'Kh√≥a h·ªçc': item.course,
                'NƒÉm h·ªçc': item.year,
                'T·ªïng s·ªë SV kh√≥a': item.total,
                'SV ra tr∆∞·ªùng nƒÉm ƒë√≥': item.graduated,
                'T·ª∑ l·ªá (%)': ((item.graduated / item.total) * 100).toFixed(1) + '%',
                'SV c√≤n l·∫°i': Math.max(0, item.remaining)
            }));
            
            // Add summary row
            const totalGraduated = filteredData.reduce((sum, item) => sum + item.graduated, 0);
            excelData.push({
                'STT': '',
                'Kh√≥a h·ªçc': 'T·ªîNG C·ªòNG',
                'NƒÉm h·ªçc': '',
                'T·ªïng s·ªë SV kh√≥a': '',
                'SV ra tr∆∞·ªùng nƒÉm ƒë√≥': totalGraduated,
                'T·ª∑ l·ªá (%)': '',
                'SV c√≤n l·∫°i': ''
            });
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(excelData);
            
            // Set column widths
            ws['!cols'] = [
                { width: 5 },   // STT
                { width: 12 },  // Kh√≥a h·ªçc
                { width: 15 },  // NƒÉm h·ªçc
                { width: 18 },  // T·ªïng s·ªë SV
                { width: 20 },  // SV ra tr∆∞·ªùng
                { width: 12 },  // T·ª∑ l·ªá
                { width: 15 }   // SV c√≤n l·∫°i
            ];
            
            XLSX.utils.book_append_sheet(wb, ws, 'Th·ªëng k√™ GDQP');
            
            // Generate filename
            const courseSelect = document.getElementById('courseSelect').value;
            const yearSelect = document.getElementById('yearSelect').value;
            let filename = 'Thong_ke_GDQP';
            if (courseSelect) filename += `_Khoa${courseSelect}`;
            if (yearSelect) filename += `_${yearSelect.replace('-', '_')}`;
            filename += `_${new Date().toISOString().slice(0, 10)}.xlsx`;
            
            // Save file
            XLSX.writeFile(wb, filename);
            
            // Show success message
            alert(`ƒê√£ xu·∫•t th√†nh c√¥ng file Excel: ${filename}`);
        }
        
        function exportOverviewToExcel() {
            // Prepare overview data for Excel
            const overviewData = [
                {
                    'Kh√≥a': 'Kh√≥a 16',
                    'T·ªïng s·ªë SV': 3000,
                    'SV ho√†n th√†nh 2024-2025': '400-600',
                    'T·ª∑ l·ªá ho√†n th√†nh': '13-20%',
                    'Tr·∫°ng th√°i': 'G·∫ßn ho√†n th√†nh'
                },
                {
                    'Kh√≥a': 'Kh√≥a 17',
                    'T·ªïng s·ªë SV': 5300,
                    'SV ho√†n th√†nh 2024-2025': '3,800-5,700',
                    'T·ª∑ l·ªá ho√†n th√†nh': '72-100%',
                    'Tr·∫°ng th√°i': 'ƒêang h·ªçc ch√≠nh'
                },
                {
                    'Kh√≥a': 'Kh√≥a 18',
                    'T·ªïng s·ªë SV': 6000,
                    'SV ho√†n th√†nh 2024-2025': '200-300',
                    'T·ª∑ l·ªá ho√†n th√†nh': '3-5%',
                    'Tr·∫°ng th√°i': 'M·ªõi b·∫Øt ƒë·∫ßu'
                },
                {
                    'Kh√≥a': 'Kh√≥a 19',
                    'T·ªïng s·ªë SV': '6,000-8,000',
                    'SV ho√†n th√†nh 2024-2025': '0',
                    'T·ª∑ l·ªá ho√†n th√†nh': '0%',
                    'Tr·∫°ng th√°i': 'S·∫Øp nh·∫≠p h·ªçc'
                },
                {
                    'Kh√≥a': 'Kh√≥a 20',
                    'T·ªïng s·ªë SV': '6,000-8,000',
                    'SV ho√†n th√†nh 2024-2025': '0',
                    'T·ª∑ l·ªá ho√†n th√†nh': '0%',
                    'Tr·∫°ng th√°i': 'S·∫Øp nh·∫≠p h·ªçc'
                }
            ];
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(overviewData);
            
            // Set column widths
            ws['!cols'] = [
                { width: 12 },  // Kh√≥a
                { width: 15 },  // T·ªïng s·ªë SV
                { width: 25 },  // SV ho√†n th√†nh
                { width: 18 },  // T·ª∑ l·ªá
                { width: 20 }   // Tr·∫°ng th√°i
            ];
            
            XLSX.utils.book_append_sheet(wb, ws, 'T·ªïng quan c√°c kh√≥a');
            
            // Generate filename
            const filename = `Tong_quan_sinh_vien_cac_khoa_${new Date().toISOString().slice(0, 10)}.xlsx`;
            
            // Save file
            XLSX.writeFile(wb, filename);
            
            // Show success message
            alert(`ƒê√£ xu·∫•t th√†nh c√¥ng file Excel: ${filename}`);
        }
        
        function exportStatisticsToExcel() {
            // Prepare statistics data for Excel
            const statisticsData = [
                {
                    'Kh√≥a': 'Kh√≥a 16',
                    '2022-2023': 1200,
                    '2023-2024': 1400,
                    '2024-2025': 500,
                    '2025-2026': 0,
                    '2026-2027': 0,
                    'T·ªïng': 3000
                },
                {
                    'Kh√≥a': 'Kh√≥a 17',
                    '2022-2023': 0,
                    '2023-2024': 800,
                    '2024-2025': 4500,
                    '2025-2026': 0,
                    '2026-2027': 0,
                    'T·ªïng': 5300
                },
                {
                    'Kh√≥a': 'Kh√≥a 18',
                    '2022-2023': 0,
                    '2023-2024': 0,
                    '2024-2025': 250,
                    '2025-2026': 4800,
                    '2026-2027': 950,
                    'T·ªïng': 6000
                },
                {
                    'Kh√≥a': 'Kh√≥a 19',
                    '2022-2023': 0,
                    '2023-2024': 0,
                    '2024-2025': 0,
                    '2025-2026': 3500,
                    '2026-2027': 3500,
                    'T·ªïng': 7000
                },
                {
                    'Kh√≥a': 'Kh√≥a 20',
                    '2022-2023': 0,
                    '2023-2024': 0,
                    '2024-2025': 0,
                    '2025-2026': 0,
                    '2026-2027': 4200,
                    'T·ªïng': 7000
                },
                {
                    'Kh√≥a': 'T·ªîNG/NƒÇM',
                    '2022-2023': 1200,
                    '2023-2024': 2200,
                    '2024-2025': 5250,
                    '2025-2026': 8300,
                    '2026-2027': 8650,
                    'T·ªïng': 28300
                }
            ];
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(statisticsData);
            
            // Set column widths
            ws['!cols'] = [
                { width: 15 },  // Kh√≥a
                { width: 12 },  // 2022-2023
                { width: 12 },  // 2023-2024
                { width: 12 },  // 2024-2025
                { width: 12 },  // 2025-2026
                { width: 12 },  // 2026-2027
                { width: 12 }   // T·ªïng
            ];
            
            XLSX.utils.book_append_sheet(wb, ws, 'Th·ªëng k√™ theo nƒÉm');
            
            // Generate filename
            const filename = `Thong_ke_sinh_vien_theo_nam_${new Date().toISOString().slice(0, 10)}.xlsx`;
            
            // Save file
            XLSX.writeFile(wb, filename);
            
            // Show success message
            alert(`ƒê√£ xu·∫•t th√†nh c√¥ng file Excel: ${filename}`);
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Add some interactive effects
            const statCards = document.querySelectorAll('.stat-card');
            statCards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-10px) scale(1.02)';
                });
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0) scale(1)';
                });
            });
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96fb6ac1a329e6c6',t:'MTc1NTI4OTQ4My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>




  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // Tab switching
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            // khi b·∫•m tab bi·ªÉu ƒë·ªì -> load chart
            if (tabName === 'charts'){
                setTimeout(initCharts, 100);
            }
        }
        
        // Course data
        const courseData = {
            '16': { total: 3000, completed: 2500, remaining: 500 },
            '17': { total: 5300, completed: 4800, remaining: 500 },
            '18': { total: 6000, completed: 250, remaining: 5750 },
            '19': { total: 7000, completed: 0, remaining: 7000 },
            '20': { total: 7000, completed: 0, remaining: 7000 }
        };
        
        let generatedSchedule = [];
        
        // Calculate batches
        function calculateBatches() {
            const totalStudents = parseInt(document.getElementById('totalStudents').value);
            const studentsPerBatch = parseInt(document.getElementById('studentsPerBatch').value);
            const weeksPerBatch = parseInt(document.getElementById('weeksPerBatch').value);
            const weeksPerYear = parseInt(document.getElementById('weeksPerYear').value);
            
            const totalBatches = Math.ceil(totalStudents / studentsPerBatch);
            const batchesPerYear = Math.floor(weeksPerYear / weeksPerBatch);
            const yearsNeeded = Math.ceil(totalBatches / batchesPerYear);
            const totalWeeksNeeded = totalBatches * weeksPerBatch;
            
            const resultDiv = document.getElementById('calculationResult');
            resultDiv.innerHTML = `
                <div class="result-box">
                    <h4>üìä K·∫øt qu·∫£ t√≠nh to√°n:</h4>
                    <p>‚Ä¢ T·ªïng s·ªë ƒë·ª£t c·∫ßn thi·∫øt: <span class="highlight">${totalBatches} ƒë·ª£t</span></p>
                    <p>‚Ä¢ S·ªë ƒë·ª£t c√≥ th·ªÉ t·ªï ch·ª©c/nƒÉm: <span class="highlight">${batchesPerYear} ƒë·ª£t</span></p>
                    <p>‚Ä¢ S·ªë nƒÉm h·ªçc c·∫ßn thi·∫øt: <span class="highlight">${yearsNeeded} nƒÉm</span></p>
                    <p>‚Ä¢ T·ªïng s·ªë tu·∫ßn gi·∫£ng d·∫°y: <span class="highlight">${totalWeeksNeeded} tu·∫ßn</span></p>
                    <p>‚Ä¢ Sinh vi√™n th·ª±c t·∫ø ƒë∆∞·ª£c ƒë√†o t·∫°o: <span class="highlight">${totalBatches * studentsPerBatch} sinh vi√™n</span></p>
                </div>
            `;
            
            if (totalBatches * studentsPerBatch > totalStudents) {
                resultDiv.innerHTML += `
                    <div class="warning">
                        ‚ö†Ô∏è L∆∞u √Ω: S·∫Ω c√≥ ${totalBatches * studentsPerBatch - totalStudents} ch·ªó tr·ªëng trong ƒë·ª£t cu·ªëi
                    </div>
                `;
            }
        }
        
        // Calculate for specific course
        function calculateCourse() {
            const courseId = document.getElementById('CourseSelect').value;
            const priority = parseInt(document.getElementById('priority').value);
            const studentsPerBatch = parseInt(document.getElementById('studentsPerBatch').value) || 600;
            const weeksPerBatch = parseInt(document.getElementById('weeksPerBatch').value) || 3;
            
            const course = courseData[courseId];
            const batchesNeeded = Math.ceil(course.remaining / studentsPerBatch);
            const weeksNeeded = batchesNeeded * weeksPerBatch;
            
            const resultDiv = document.getElementById('courseResult');
            resultDiv.innerHTML = `
                <div class="result-box">
                    <h4>üéØ K·∫øt qu·∫£ cho Kh√≥a ${courseId}:</h4>
                    <p>‚Ä¢ Sinh vi√™n c√≤n l·∫°i: <span class="highlight">${course.remaining.toLocaleString()}</span></p>
                    <p>‚Ä¢ S·ªë ƒë·ª£t c·∫ßn thi·∫øt: <span class="highlight">${batchesNeeded} ƒë·ª£t</span></p>
                    <p>‚Ä¢ S·ªë tu·∫ßn gi·∫£ng d·∫°y: <span class="highlight">${weeksNeeded} tu·∫ßn</span></p>
                    <p>‚Ä¢ M·ª©c ƒë·ªô ∆∞u ti√™n: <span class="highlight">${priority}/5</span></p>
                    <p>‚Ä¢ Th·ªùi gian ho√†n th√†nh d·ª± ki·∫øn: <span class="highlight">${Math.ceil(weeksNeeded / 38)} nƒÉm h·ªçc</span></p>
                </div>
            `;
        }
        
        // Calculate date ranges for academic weeks
        function getAcademicWeekDates(year, weekNumber) {
            // Academic year starts in late August (week 35 of calendar year)
            const academicYearStart = new Date(year, 7, 20); // August 20th
            const startDate = new Date(academicYearStart);
            startDate.setDate(startDate.getDate() + (weekNumber - 1) * 7);
            
            const endDate = new Date(startDate);
            endDate.setDate(endDate.getDate() + 6);
            
            const formatDate = (date) => {
                return `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()}`;
            };
            
            return {
                start: formatDate(startDate),
                end: formatDate(endDate)
            };
        }
        
        // Generate schedule
        function generateSchedule() {
            const startYear = parseInt(document.getElementById('startYear').value);
            const maxBatchesPerYear = parseInt(document.getElementById('maxBatchesPerYear').value);
            const strategy = document.getElementById('strategy').value;
            const studentsPerBatch = 600;
            const weeksPerBatch = 3;
            
            generatedSchedule = [];
            let currentYear = startYear;
            let batchesThisYear = 0;
            let batchNumber = 1;
            
            // Create priority queue based on strategy
            let courseQueue = [];
            if (strategy === 'priority') {
                courseQueue = ['16', '17', '18', '19', '20'];
            } else if (strategy === 'balanced') {
                courseQueue = ['16', '17', '18', '19', '20'];
            } else {
                courseQueue = ['16', '17', '18', '19', '20'];
            }
            
            // Generate schedule for each course
            courseQueue.forEach(courseId => {
                const course = courseData[courseId];
                let remaining = course.remaining;
                
                while (remaining > 0) {
                    if (batchesThisYear >= maxBatchesPerYear) {
                        currentYear++;
                        batchesThisYear = 0;
                    }
                    
                    const studentsInBatch = Math.min(remaining, studentsPerBatch);
                    const startWeek = (batchesThisYear * weeksPerBatch) + 1;
                    const endWeek = startWeek + weeksPerBatch - 1;
                    
                    // Calculate actual dates
                    const startDates = getAcademicWeekDates(currentYear, startWeek);
                    const endDates = getAcademicWeekDates(currentYear, endWeek);
                    
                    generatedSchedule.push({
                        batch: batchNumber,
                        year: `${currentYear}-${currentYear + 1}`,
                        course: `Kh√≥a ${courseId}`,
                        students: studentsInBatch,
                        weeks: `Tu·∫ßn ${startWeek}-${endWeek}`,
                        startWeek: startWeek,
                        endWeek: endWeek,
                        dateRange: `${startDates.start} - ${endDates.end}`,
                        startDate: startDates.start,
                        endDate: endDates.end
                    });
                    
                    remaining -= studentsInBatch;
                    batchesThisYear++;
                    batchNumber++;
                }
            });
            
            displaySchedule();
        }
        
        // Display generated schedule
        function displaySchedule() {
            const resultDiv = document.getElementById('scheduleResult');
            
            if (generatedSchedule.length === 0) {
                resultDiv.innerHTML = '<p>Ch∆∞a c√≥ l·ªãch h·ªçc n√†o ƒë∆∞·ª£c t·∫°o.</p>';
                return;
            }
            
            // Group by year
            const scheduleByYear = {};
            generatedSchedule.forEach(item => {
                if (!scheduleByYear[item.year]) {
                    scheduleByYear[item.year] = [];
                }
                scheduleByYear[item.year].push(item);
            });
            
            let html = '<div class="result-box"><h4>üìÖ L·ªãch h·ªçc ƒë∆∞·ª£c t·∫°o:</h4>';
            html += `<p>‚Ä¢ T·ªïng s·ªë ƒë·ª£t: <span class="highlight">${generatedSchedule.length} ƒë·ª£t</span></p>`;
            html += `<p>‚Ä¢ S·ªë nƒÉm h·ªçc: <span class="highlight">${Object.keys(scheduleByYear).length} nƒÉm</span></p></div>`;
            
            Object.keys(scheduleByYear).forEach(year => {
                html += `<div class="schedule-item">`;
                html += `<h5>üìö NƒÉm h·ªçc ${year} (${scheduleByYear[year].length} ƒë·ª£t)</h5>`;
                html += `<div class="table-container"><table>`;
                html += `<thead><tr><th>ƒê·ª£t</th><th>Kh√≥a</th><th>SV</th><th>Tu·∫ßn h·ªçc</th><th>Th·ªùi gian c·ª• th·ªÉ</th></tr></thead><tbody>`;
                
                scheduleByYear[year].forEach(batch => {
                    html += `<tr>`;
                    html += `<td>ƒê·ª£t ${batch.batch}</td>`;
                    html += `<td>${batch.course}</td>`;
                    html += `<td>${batch.students}</td>`;
                    html += `<td>${batch.weeks}</td>`;
                    html += `<td><strong>${batch.dateRange}</strong></td>`;
                    html += `</tr>`;
                });
                
                html += `</tbody></table></div></div>`;
            });
            
            resultDiv.innerHTML = html;
        }
        
        // Export schedule to Excel
        function exportSchedule() {
            if (generatedSchedule.length === 0) {
                alert('Vui l√≤ng t·∫°o l·ªãch h·ªçc tr∆∞·ªõc khi xu·∫•t Excel!');
                return;
            }
            
            const excelData = generatedSchedule.map(item => ({
                'ƒê·ª£t': `ƒê·ª£t ${item.batch}`,
                'NƒÉm h·ªçc': item.year,
                'Kh√≥a': item.course,
                'S·ªë sinh vi√™n': item.students,
                'Tu·∫ßn h·ªçc': item.weeks,
                'Th·ªùi gian c·ª• th·ªÉ': item.dateRange,
                'Ng√†y b·∫Øt ƒë·∫ßu': item.startDate,
                'Ng√†y k·∫øt th√∫c': item.endDate
            }));
            
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(excelData);
            
            ws['!cols'] = [
                { width: 10 }, { width: 15 }, { width: 12 }, 
                { width: 15 }, { width: 15 }, { width: 20 }, { width: 15 }, { width: 15 }
            ];
            
            XLSX.utils.book_append_sheet(wb, ws, 'L·ªãch h·ªçc GDQP');
            
            const filename = `Lich_hoc_GDQP_${new Date().toISOString().slice(0, 10)}.xlsx`;
            XLSX.writeFile(wb, filename);
            
            alert(`ƒê√£ xu·∫•t th√†nh c√¥ng: ${filename}`);
        }
        
        // Export summary
        function exportSummary() {
            const totalRemaining = Object.values(courseData).reduce((sum, course) => sum + course.remaining, 0);
            const totalBatches = Math.ceil(totalRemaining / 600);
            
            const summaryData = [
                { 'Th√¥ng tin': 'T·ªïng sinh vi√™n c√≤n l·∫°i', 'Gi√° tr·ªã': totalRemaining },
                { 'Th√¥ng tin': 'T·ªïng s·ªë ƒë·ª£t c·∫ßn thi·∫øt', 'Gi√° tr·ªã': totalBatches },
                { 'Th√¥ng tin': 'S·ªë nƒÉm h·ªçc d·ª± ki·∫øn', 'Gi√° tr·ªã': Math.ceil(totalBatches / 12) },
                { 'Th√¥ng tin': 'T·ªïng tu·∫ßn gi·∫£ng d·∫°y', 'Gi√° tr·ªã': totalBatches * 3 }
            ];
            
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.json_to_sheet(summaryData);
            
            XLSX.utils.book_append_sheet(wb, ws, 'T√≥m t·∫Øt');
            
            const filename = `Tom_tat_GDQP_${new Date().toISOString().slice(0, 10)}.xlsx`;
            XLSX.writeFile(wb, filename);
            
            alert(`ƒê√£ xu·∫•t t√≥m t·∫Øt: ${filename}`);
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            calculateBatches();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'972fb6ef01010495',t:'MTc1NTgzNzg2Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>


</body>
</html>
